## 1장 멀티스레딩

---

### 1.3 멀티스레드 프로그래밍은 언제 해야 하나?

- 똑같은 연산을 해도 멀티스레드로 할 경우 연산 속도가 훨씬 더 느려지기도 한다.
- 멀티스레드 프로그래밍은 조금만 실수해도 오류를 일으키고, 오류를 찾기 힘들때도 많다.

- 왜 해야 하지라는 답을 분명하게 해야한다.
  - 1. 오래 걸리는 일 하나와 빨리 끝나는 일 여럿을 같이 해야 할 때
  - 2. 어떤 긴 처리를 진행하는 동안 다른 짧은 일을 처리해야 할 때
  - 3. 기기에 있는 CPU를 모두 활용할 때

#### 1.3.1 오래 걸리는 일 하나와 빨리 끝나는 일 여럿을 같이 해야 할 때

- 게임 프로그램의 로딩의 예.

- 게임을 켜고 스테이지 들어가기 전, 그래픽 리소스를 로딩하기 위해 많은 양의 데이터를 읽어야 한다.
- 지루함을 덜고자 로딩을 통해 그래프로 보여준다.
- 혹은 애니메이션 등을 화면에 뿌려주거나 요즘엔 간단한 미니게임을 넣는 경우도 있다.(남코의 저작권이 있었으나 15년에 풀렸다.)

- 멀티스레딩을 하지 않는다면 하나 로딩하고 렌더링하기를 반복해야 한다.

```c++
LoadScene()
{
  Render();
  LoadScene();
  Render();
  LoadModel();
  Render();
  LoadTexture();
  Render();
  LoadAnimation();
  Render();
  LoadSound();
}
```

- 큰 파일을 로딩하는 동안 프레임률이 끊길 것이다.
- 큰파일은 부분(chunk)단위로 로딩하며 렌더링을 할 예정이다.

- 아래처럼 멀티 스레드를 이용하면 문제를 해결할 수 있다.

```c++
bool isStillLoading; // 전역 변수

Thread1
{
  isStillLoading = true;
  while (isStillLoading)
  {
      FrameMove();
      Render();
  }
}

Thread2
{
  LoadScene();
  LoadModel();
  LoadTexture();
  LoadAnimation();
  LoadSound();

  isStillLoading = false;
}
```

- Thread1에서 게임루프를 돈다. 렌더링을 지속적으로 수행한다.
- Thread2에서 게임에 필요한 데이터를 디스크에서 로딩한다.
- 로딩이 끝나면 특정 변수를 변경하고 Thread1에서 변수가 변경될 때까지 로딩 화면을 반복해서 렌더링 한다.

---

#### 1.3.2
