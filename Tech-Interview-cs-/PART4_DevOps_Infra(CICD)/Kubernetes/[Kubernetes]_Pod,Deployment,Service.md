# 🌐 쿠버네티스(Kubernetes), Pod, Deployment, Service

## 🎯 1. Kubernetes의 기본적인 워크로드와 네트워크 개념 이해

## 1-1. Pod / Deployment / Service

### 🚀 Pod(파드) - 가장 작은 실행 단위

- 쿠버네티스의 최소 배포 단위: 하나 또는 여러 개의 컨테이너가 함께 묶인 그룹
- 비유: 마치 원룸 아파트와 비슷하다. 하나의 방 안에 필요한 모든것들이 들어있다.

🔍 Pod의 핵심 개념

1. **공유 환경 - "한 지붕 아래"**

   - **같은 IP 주소**: Pod 내 모든 컨테이너는 동일한 네트워크 인터페이스를 공유
   - **공유 저장소**: 볼륨을 통해 컨테이너 간 파일 시스템 공유 가능
   - **로컬 통신**: 컨테이너들이 localhost를 통해 서로 통신 가능

2. **생명주기의 원자성 - "함께 태어나고 함께 죽는다"**

   - **동시 생성**: Pod 내 모든 컨테이너가 함께 시작된다.
   - **동시 종료**: 하나의 컨테이너가 실패하면 전체 Pod이 재시작된다.
   - **운명 공동체**: Pod은 분리될 수 없는 하나의 단위로 취급한다.

3. **임시적 존재 - "언제든 사라질 수 있다"**
   - **휘발성**: Pod은 언제든 삭제되고 재생성될 수 있다.
   - **상태 비저장**: Pod 자체는 상태를 저장하지 않는다.
   - **IP 변동성**: Pod이 재생성되면 새로운 IP주소를 받는다.

🤔 Pod의 설계 철학 -> 컨테이너를 Pod로 묶는 이유

- **밀접한 협력**: 웹 서버 + 로그 수집기처럼 긴밀하게 협력하는 컨테이너들
- **리소스 공유**: 같은 데이터를 사용하거나 네트워크를 공유해야 하는 경우
- **사이드카 패턴**: 메인 애플리케이션을 보조하는 컨테이너들 (모니터링, 프록시 등)

---

### 📋 Deployment - "애플리케이션 배포 관리자"

#### 🚀 Deployment란?

- **Pod의 생명주기를 관리하는 상위 개체**: Pod을 생성, 삭제, 업데이트하는 관리자
- 건축 현장의 현장 감독과 비슷하다. 설계도 -> 집 짓기 -> 수리 -> 증축 등

#### 🔍 Deployment의 핵심 역할

1. **선언적 관리 - "원하는 상태를 선언(스스로)"**

   - **목표 상태 정의**: 웹 서버 Pod을 3개 유지
   - **자동 조정**: 현재 상태와 목표 상태를 비교하여 자동으로 조정
   - **지속적 감시**: 24시간 상태를 모니터링하여 목표 상태를 유지한다.

2. **자동 치유 - "무인 관리 시스템"**

   - **장애 감지**: Pod이 비정상 상태가 되면 즉시 감지한다.
   - **자동 복구**: 꺼진 Pod를 삭제하고 새로운 Pod를 자동 생성한다.
   - **노드 장애 대응**: 전체 노드가 다운되면 다른 노드에서 Pod를 재생성한다.

3. **확장성 관리 - "탄력적 운영"**

   - **수평 확장**: 트래픽 증가 시 Pod 개수를 쉽게 증가시킨다.
   - **즉시 적용**: 값만 변경하면 바로 확장 / 축소를 실행한다.
   - **부하 분산**: 여러 Pod에 트래픽을 자동으로 분산한다.

4. **무중단 업데이트 - "서비스 중단 없는 업그레이드"**
   - **롤링 업데이트**: 기존 Pod을 하나씩 새 버전으로 교체한다.
   - **점진적 배포**: 서비스 중단 없이 안전하게 업데이트 한다.
   - **자동 롤백**: 문제 발생 시 이전 버전으로 즉시 되돌린다.

#### 🎯 Deployment vs Pod 직접 관리

- Pod 직접 사용 시 문제점

  - **수동 관리**: Pod이 꺼지면 수동으로 재생성이 필요하다.
  - **확장 어려움**: 트래픽이 증가시 일일이 Pod를 추가해야 한다.
  - **업데이트 복잡**: 새 버전 배포 시 서비스 중단이 불가피하다.

- Deployment 사용 시 장점
  - **수동 관리**: 모든 것이 자동으로 처리된다.
  - **확장 어려움**: 항상 원하는 개수의 Pod를 보장한다.
  - **업데이트 복잡**: 간단한 명령어로 복잡한 작업을 수행한다.
-
