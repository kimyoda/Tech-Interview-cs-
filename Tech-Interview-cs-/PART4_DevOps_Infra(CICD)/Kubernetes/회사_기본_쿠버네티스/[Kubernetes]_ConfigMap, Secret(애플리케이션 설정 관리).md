# 🌐 쿠버네티스(Kubernetes), ConfigMap, Secret: 애플리케이션 설정 관리

## 🎯 1. Kubernetes의 애플리케이션 설정 관리

## 1-3. ConfigMap, Secret

### 🎯 애플리케이션 설정을 관리하는 방법

- 설정 정보와 민감한 데이터를 안전하고 효율적으로 관리하는 것

---

### 📋 ConfigMap -> 설정 정보의 외부화

#### 🚀 ConfigMap?

- **애플리케이션 설정 데이터를 저장하는 쿠버네티스 오브젝트**: 코드와 설정을 분리, 관리할 수 있는 설정 저장소이다.
- 환경설정 파일, 실행 환경에 따라 다른 설정을 적용할 수 있다.

🔍 ConfigMap의 핵심 개념

1. **로드와 설정의 분리 -> 하드코딩 지양**

   - **설정 외부화**: 설정값을 분리한다.
   - **환경 설정**: 개발, 테스트, 프로덕션 환경마다 다른 설정 적용 가능하다.
   - **재사용성**: 동일한 애플리케이션 이미지로 다양한 환경에서 실행한다.

2. **키-값 저장소 -> 이름을 붙여 보관**

   - **구조화된 데이터**: 설정을 키-값 쌍으로 체계적으로 저장한다.
   - **다양한 형식**: 단순 문자열, 전체 설정 파일까지 저장 가능하다.
   - **논리적 그룹**: 하나의 ConfigMap으로 묶어서 관리한다.

3. **동적 주입 -> 실행 시점에 설정을 전달**
   - **환경 변수**: Pod실행 시 환경변수로 설정값을 주입한다.
   - **볼륨 마운트**: 설정 파일을 Pod 내부 파일 시스템에 마운트한다.
   - **실시간 반영**: 설정 변경 시 애플리케이션 재배포 없이 적용이 가능하다.

🤔 ConfigMap 주요 사용 예시

1. 애플리케이션 섫정

   - 데이터베이스 연결정보(호스트명, 포트, 데이터베이스 등).
   - API엔드포인트(외부서비스 URL)
   - 기능플래그(특정 기능 활성화)
   - 로깅레벨(DEBUG, INFO 등 로그출력)

2. 환경별 설정(실행)

   - 개발환경: 디버그모드 활성화
   - 테스트환경: 테스트 데이터베이스
   - 프로덕션 환경: 성능최적화

3. 설정파일관리(설정 쉽게)
   - 웹 서버 설정(NGINX, APACHE 등)
   - 애플리케이션 설정(properties, yaml, config)
   - 스크립트 파일(스크립트)

🤔 ConfigMap 사용의 이점

1. 유연성 증대

   - 하나의 컨테이너 이미지로 여러 환경을 대응한다.
   - 코드 수정없이 설정만 변경하여 동작을 조정한다.
   - 카나리 배포등에 활용한다.

2. 운영효율성

   - 중앙 관리
   - 버전 관리
   - 일관성 보장

3. 보안향상
   - 민감하지 않은 정보, 접근 제어, 감사 추적등이 있다.

---

### 🚦🔐 Secret - "민감한 정보의 안전한 보관"

#### 🚀 Secret이란?

- **민감한 데이터를 안전하게 저장, 관리하는 쿠버네티스 오브젝트**: 비밀번호, API키, 인증서 등 보안이 중요한 정보 보호 후 애플리케이션에 전달
- 금고와 비슷하다. 중요한 것들을 안전하게 보관 및 관리

#### 🔍 Secret의 핵심 개념

1. 보안강화(민감한 정보 안전)

   - 암호화 저장(etcd에 Base64로 인코딩 저장)
   - 메모리 저장(Pod내에 마운트)
   - 자동 정리(Pod 종료, 데이터 자동삭제)

2. 접근 제어(권한)

   - RBAC 통합(역할기반 접근 제어)
   - 네임스페이스 격리(Secret은 동일 네임스페이스내 접근)
   - 최소권한 원칙(필요한 Secret만 필요한 Pod 제공)

3. 다양한 타입(용도에 맞게)
   - Generic(키-값 쌍 데이터)
   - DockerRegistry(컨테이너 이미지 저장소 인증)
   - TLS(SSL/TLS 인증서, 개인키)
   - Service Account(쿠버네티스 API 접근 토큰)

#### 🎯 Secret의 주요 사용 사례

1. 인증 정보(증명)

   - 데이터베이스 비밀번호(Mysql 접속 암호)
   - API 키(외부서비스 인증)
   - OAuth토큰(소셜로그인, 외부 API 인증)
   - JWT 시크릿(토큰 서명 비밀키)

2. TTS인증서(안전)

   - HTTPS인증서
   - 클라이언트 인증서
   - CA 인증서

3. 컨테이너 레지스트리(프라이빗 이미지 접근)
   - DockerHub(프라이빗 리포 접근)
   - AWS ECR: Amazon Elastic Container Registry 인증
   - 사내 레지스토리
