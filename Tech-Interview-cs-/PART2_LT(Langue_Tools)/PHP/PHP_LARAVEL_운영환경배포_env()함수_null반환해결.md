# ğŸŒ Laravel ë°°í¬ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…: `env()` ê°€ nullì„ ë°˜í™˜í•  ë•Œ

### ğŸ“š ëª©ì°¨

- [ğŸŒ Laravel ë°°í¬ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…: `env()` ê°€ nullì„ ë°˜í™˜í•  ë•Œ](#-laravel-ë°°í¬-íŠ¸ëŸ¬ë¸”-ìŠˆíŒ…-env-ê°€-nullì„-ë°˜í™˜í• -ë•Œ)
    - [ğŸ“š ëª©ì°¨](#-ëª©ì°¨)
  - [1. ë¬¸ì œ ìš”ì•½](#1-ë¬¸ì œ-ìš”ì•½)
  - [2. ì™œ env()ê°€ NULLì´ ë˜ëŠ”ê°€?](#2-ì™œ-envê°€-nullì´-ë˜ëŠ”ê°€)
  - [3. ì¬í˜„ ë°©ë²• (ë¡œì»¬, ìºì‹œ í›„)](#3-ì¬í˜„-ë°©ë²•-ë¡œì»¬-ìºì‹œ-í›„)
- [ìš´ì˜ í™˜ê²½](#ìš´ì˜-í™˜ê²½)
  - [4. í•´ê²° ì „ëµ:  env() -\> config()](#4-í•´ê²°-ì „ëµ--env---config)
  - [5. ì˜ˆì œ ì½”ë“œ](#5-ì˜ˆì œ-ì½”ë“œ)
    - [ë°°í¬, ìš´ì˜ ì²´í¬](#ë°°í¬-ìš´ì˜-ì²´í¬)
---

## 1. ë¬¸ì œ ìš”ì•½
  - `env()` ë° ê´€ë ¨ íŒŒì¼ì„ ìˆ˜ì •í•˜ì—¬ aws s3ì— ìƒˆë¡­ê²Œ ì—…ë¡œë“œí•˜ì—¬ íŒŒì¼ ê²½ë¡œë¥¼ ë³€ê²½í•˜ê¸° ìœ„í•´ `env`ì•ˆì— ìˆëŠ” ê²½ë¡œ ë£¨íŠ¸ë¥¼ ìˆ˜ì •í•˜ê³  `php artisan cofnig:cache, clear` ë¼ëŠ” ëª…ë ¹ì–´ ë“±ì„ í†µí•´ ì›í™œíˆ ì‘ë™í•  ìˆ˜ ìˆë„ë¡ ë¡œì»¬ì—ì„œ ì§„í–‰í•˜ê³  ë°˜ì˜í•œë’¤ ë°°í¬ê°€ ëë‚œ í›„ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•  ë•Œ, ì§€ì •í•´ë‘” ê²½ë¡œëŠ” ì•„ì˜ˆ ë³´ì´ì§€ ì•Šê³  ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ ëœ ì´ìŠˆë¥¼ í™•ì¸í–ˆì—ˆë‹¤. ì•„ë˜ëŠ” ì´ ê³¼ì •ì„ í•´ê²°í•˜ê³  ì–´ë–»ê²Œ í•´ê²°í–ˆëŠ” ì§€ ê¸°ë¡ìœ¼ë¡œ ë‚¨ê²¨ë‘ì—ˆë‹¤.
  - Laravelì€ `.env`ë¡œ í™˜ê²½ë³„ ì„¤ì •ì„ ê´€ë¦¬í•œë‹¤.
  - í•˜ì§€ë§Œ ìš´ì˜(ë˜ëŠ” ê°œë°œ ì„œë²„)ì—ì„œ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ì— `php artisan config:cache`ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ(ì»¨íŠ¸ë¡¤ëŸ¬/ì„œë¹„ìŠ¤/ë·° ë“±)ì—ì„œ `env()`ë¥¼ í˜¸ì¶œí•  ë•Œ `null`ì´ ë°˜í™˜ë˜ëŠ” í˜„ìƒì„ ê²½í—˜í•  ìˆ˜ ìˆë‹¤.
```php
$iamgeUrl = env('CDN_BASE_URL') . '/images/example.jpg';
```

## 2. ì™œ env()ê°€ NULLì´ ë˜ëŠ”ê°€?

   - ìš´ì˜ í™˜ê²½ ì„±ëŠ¥ì„ ìœ„í•´ `php artisan config:cache` ëª…ë ¹ì„ ì‹¤í–‰, ëª¨ë“  ì„¤ì • íŒŒì¼(`config/*.php`)ì™€ `.env` ë³€ìˆ˜ë¥¼ í•˜ë‚˜ì˜ PHP íŒŒì¼ë¡œ ìºì‹±í•œë‹¤.
   - ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ì— ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ í¬í•¨í•œë‹¤. í•´ë‹¹ ëª…ë ¹ì–´ê°€ ì‹¤í–‰ë˜ë©´ ë¼ë¼ë²¨ì€ `conifg/` ë””ë ‰í„°ë¦¬ì— ìˆëŠ” ëª¨ë“  íŒŒì¼ì„ í•˜ë‚˜ë¡œ ë¬¶ì–´ì„œ `boostrap/cache/config.php` ë¼ëŠ” í•˜ë‚˜ì˜ PHP íŒŒì¼ë¡œ ë§Œë“ ë‹¤. í•´ë‹¹ íŒŒì¼ë§Œ ë¡œë“œí•œë‹¤.

   > **Laravel ê³µì‹ ë¬¸ì„œ**
   > â€œIf you execute the config:cache  command during your deployment process, you should be sure that you are only calling the env function from within your configuration files.â€
   > ë°°í¬ ê³¼ì •ì—ì„œ `config:cache`ë¥¼ ì‹¤í–‰í•˜ë©´, `env()` í˜¸ì¶œì€ ë°˜ë“œì‹œ ì„¤ì • íŒŒì¼(`config`)ë‚´ë¶€ì—ì„œë§Œ í•´ì•¼í•œë‹¤. ë¼ëŠ” ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.

   - ì„¤ì •ì´ ìºì‹±ëœ ì´í›„ `.env` íŒŒì¼ì´ ë¡œë“œë˜ì§€ ì•Šê³  `env()` í•¨ìˆ˜ëŠ” ì™¸ë¶€ ì‹œìŠ¤í…œ ë³€ìˆ˜ë§Œ ë°˜í™˜í•œë‹¤ê³  í•œë‹¤.
   `config:cache` ì‹¤í–‰ í›„ .`env` íŒŒì¼ì—ì„œ ë¡œë“œí•œ í™˜ê²½ ë³€ìˆ˜ë“¤ì´ ë” ì´ìƒ ì½íˆì§€ ì•Šê³ , ì• í”Œë¦¬ì¼€ì´ì…˜ ê³³ê³³ì—ì„œ `env()`ë¥¼ í˜¸ì¶œí•˜ë©´ NULLì´ ë°˜í™˜ëœë‹¤.

   > í™˜ê²½ ë³€ìˆ˜ê°€ `.env` íŒŒì¼ì—ì„œ ë¡œë“œë˜ëŠ” ê²ƒì€ ìºì‹œëœ ì„¤ì • íŒŒì¼ ì—†ì„ ë•Œ, í•œë²ˆ `config:cache` ë¥¼ ì‹¤í–‰í•˜ë©´ Laravelì€ ë” ì´ìƒ `.env` íŒŒì¼ì„ ë¡œë“œí•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ë•Œ ì• í”Œë¦¬ì¼€ì´ì…˜ `env()` í—¬í¼ë¥¼ í˜¸ì¶œí•˜ë©´ ê¸°ë³¸ê°’ `null` ì„ ë°˜í™˜í•˜ê²Œ ëœë‹¤.

   - ìºì‹±ì´ ë˜ëŠ” ìˆœê°„, `env` ëŠ” ë¡œë“œë˜ì§€ ì•Šì•„ ì„¤ì • íŒŒì¼(`config/*.php`) ë‚´ë¶€ë¥¼ ì œì™¸í•œ ì½”ë“œ(ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, ë·° ë“±)ì—ì„œ í˜¸ì¶œí•˜ëŠ” `env()`ëŠ” ì „ë¶€ `NULL`ì„ ë°˜í™˜í•˜ê²Œ ëœë‹¤ã….

## 3. ì¬í˜„ ë°©ë²• (ë¡œì»¬, ìºì‹œ í›„)

```bash
# ë¡œì»¬ í™˜ê²½
php artisan config:clear
php artisan tinker
>>> env('CDN_BASE_URL')
=> "https://date.app.example.jp/"
```
- `.env`ê°’ì´ ì •ìƒ ì¶œë ¥ëœë‹¤.

# ìš´ì˜ í™˜ê²½ 
```bash
php artisan config:cache
php artisan tinker
>>> env('CDN_BASE_URL')
=> null
```
- í•˜ì§€ë§Œ `config()`ë¡œ ì ‘ê·¼í•˜ë©´ ê°’ì´ ë‚˜ì˜¨ë‹¤.
```bash
>>> config('app.cdn.base_url')

>>> config('filesystems.cdn_base_url') // í”„ë¡œì íŠ¸ì— ë”°ë¼ ë§¤í•‘ ìœ„ì¹˜ê°€ ë‹¤ë¥´ë‹¤.
```

## 4. í•´ê²° ì „ëµ:  env() -> config()
- `.env`ì— ìˆëŠ” ê°’ì€ `config/*.php`ì— ë§¤í•‘í•œë‹¤.
- ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œëŠ” `env()`ê°€ ì•„ë‹ˆë¼ `config()`ë¡œ ì½ëŠ”ë‹¤.

-> `config:cache` ì´í›„ì—
  - ì„¤ì • ê°’ì€ ìºì‹œ(`bootstrap/cache/config.php`)ë¥¼ í†µí•´ ì œê³µëœë‹¤.
  - `config()`ëŠ” ìºì‹œëœ ì„¤ì •ì„ ì•ˆì •ì ìœ¼ë¡œ ì½ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.


---

## 5. ì˜ˆì œ ì½”ë“œ

5-1 .env ì˜ˆì‹œ
```php
APP_ENV_NAME="dev-example"
CDN_BASE_URL="https://data.app.example.jp/"
CDN_IMAGE_DIR="/html/examples"
CDN_IMAGE_INFO_DIR="/example_banner"
```

5-2. Before: ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ env() ì§ì ‘ ì‚¬ìš©
```php
// íŒŒì¼ ì—…ë¡œë“œ ë¶€ë¶„ë§Œ
if ($request->file('file')) {
  $appEnvName = '/' . env('APP_ENV_NAME'. "dev-exmaple-2026");
  $imageUrl = $appEnvName . env('CDN_IMAGE_DIR');
  $bannerImageUrl = $imageUrl . env('CDN_IMAGE_INFO_DIR');
};

$fileUrl = env('CDN_BASE_URL') . $filePath;
```

5-3. config/app.phpì— CDN ì„¤ì • ë§¤í•‘ ì¶”ê°€
> env()ëŠ” ì—¬ê¸°(config íŒŒì¼)ì—ì„œ ì‚¬ìš©í•œë‹¤.
```php
// coonfig/app.php

return [
    // í”„ë¡œì íŠ¸ ì‚¬ìš© ì¤‘ì¸ env_name
    'env_name' => env('APP_ENV_NAME', 'dev-example-2026'),

    // CDN ê´€ë ¨ì„¤ì •
    'cdn' => [
      'base_url' => env('CDN_BASE_URL', 'http://localhost'),
      'image_dir' => env('CDN_IMAGE_DIR', ''),
      'image_info_dir' => env('CDN_IMAGE_INFO_DIR');
    ],
  ];
```

5-4. After: ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ config()ì‚¬ìš©
```php
// íŒŒì¼ ì—…ë¡œë“œ ë¶€ë¶„ë§Œ
if ($request->file('file')) {
  $appEnvName = '/' . config('app.env_name'. "dev-exmaple-2026");
  $imageUrl = $appEnvName . config('app.cdn.base_url', '');
  $bannerImageUrl = $imageUrl . config('app.cdn.image_info_dir', '');
};

$fileUrl = $baseUrl . $filePath;
```

- ì•ìœ¼ë¡œëŠ” í™˜ê²½ ë³€ìˆ˜ëŠ” `config` í´ë” ë‚´ íŒŒì¼ ë“± ë§¤í•‘ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œìœ í•œë‹¤.


---

### ë°°í¬, ìš´ì˜ ì²´í¬

- `php artisan config:cache`ëŠ” ì„±ëŠ¥ìƒ ê¶Œì¥í•œë‹¤.
- ë‹¨, config íŒŒì¼ ë°–ì—ì„œ env() í˜¸ì¶œí•˜ëŠ”ê±´ ì§€ì–‘í•œë‹¤.

- .env ìˆ˜ì • í›„ ë°˜ì˜ì´ ì•ˆë ë•ŒëŠ”
- `php arttisan cofnig:clear`, `php artisan optimize:clear` ë¼ëŠ” ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•œë‹¤.


   

